<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard – Tests Backend & Base de Données</title>

  <link rel="stylesheet" href="style.css">
</head>

<body>

  <header class="header">
      <h1>Monitoring CI/CD</h1>
      <p class="subtitle">Vérification du backend & PostgreSQL</p>
  </header>

  <main class="main-container">
      
      <section class="card">
          <h2>Statut API</h2>
          <div id="api-response" class="response">Chargement...</div>
      </section>

      <section class="card">
          <h2>Données de la Base</h2>
          <div id="db-response" class="response">Chargement...</div>
      </section>

  </main>

  <script>
    const BACKEND_URL = "https://projectdevops-backend-kc5p.onrender.com";

    console.log("→ Test du backend:", BACKEND_URL);

    async function fetchAPI() {
      try {
        const r = await fetch(`${BACKEND_URL}/api`);
        const data = await r.json();
        document.getElementById("api-response").innerHTML =
          `<pre>${JSON.stringify(data, null, 2)}</pre>`;
      } catch (err) {
        document.getElementById("api-response").innerHTML =
          `<span class="error">Erreur API : ${err.message}</span>`;
      }
    }

    async function fetchDB() {
      try {
        const r = await fetch(`${BACKEND_URL}/db`);
        const data = await r.json();
        document.getElementById("db-response").innerHTML =
          `<pre>${JSON.stringify(data, null, 2)}</pre>`;
      } catch (err) {
        document.getElementById("db-response").innerHTML =
          `<span class="error">Erreur DB : ${err.message}</span>`;
      }
    }

    fetchAPI();
    fetchDB();
  </script>
</body>
</html>
